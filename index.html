<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Destravar Sistema Paulo</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #eee; }
        .container { max-width: 400px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
        .card { border: 1px solid #ccc; padding: 10px; margin-top: 10px; border-radius: 5px; background: #f9f9f9; }
        input { width: 100%; padding: 8px; margin: 5px 0; box-sizing: border-box; }
        button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <h3>Novo Pedido</h3>
    <input type="text" id="cli" placeholder="Nome do Cliente">
    <input type="text" id="prod" placeholder="Produto">
    <button onclick="cadastrar()">LANÇAR NO SISTEMA</button>

    <hr>
    <div id="lista">Sincronizando...</div>
</div>

<script>
    // ⚠️ COLE SEU NOVO LINK AQUI ABAIXO
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxptJfRSBxTmxJHyxFulO2zYWnrLAaZxd-U00VKITcp21rYTuExf7KYSOM05AR8qHoaBA/exec"; 

    async function listar() {
        const listaDiv = document.getElementById('lista');
        try {
            const res = await fetch(SCRIPT_URL);
            const data = await res.json();
            
            listaDiv.innerHTML = '<h4>Pedidos na Fila:</h4>';
            
            if (data.length === 0) {
                listaDiv.innerHTML += "Nenhum pedido encontrado.";
                return;
            }

            data.forEach(p => {
                const div = document.createElement('div');
                div.className = 'card';
                // Usando nomes em minúsculo conforme o script do google envia agora
                div.innerHTML = `
                    <b>Cliente:</b> ${p.cliente || 'Sem nome'}<br>
                    <b>Produto:</b> ${p.produto || '-'}<br>
                    <button style="background:red; padding:2px; font-size:10px;" onclick="deletar('${p.id}')">EXCLUIR</button>
                `;
                listaDiv.appendChild(div);
            });
        } catch (e) {
            listaDiv.innerHTML = "<b style='color:red'>ERRO DE CONEXÃO:</b> Verifique o link do script.";
            console.error(e);
        }
    }

    async function cadastrar() {
        const cli = document.getElementById('cli').value;
        const prod = document.getElementById('prod').value;
        if(!cli) return alert("Digite o nome!");

        try {
            await fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({
                    action: "add",
                    id: String(Date.now()),
                    cliente: cli,
                    produto: prod,
                    cor: "",
                    dataEnvio: "",
                    status: "Criar arte",
                    quitado: ""
                })
            });
            document.getElementById('cli').value = "";
            document.getElementById('prod').value = "";
            listar();
        } catch(e) {
            alert("Erro ao salvar");
        }
    }

    listar();
</script>
</body>
</html>
